<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Trait Simulation Tutorial · TraitSimulation</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>TraitSimulation</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li class="current"><a class="toctext" href>Trait Simulation Tutorial</a><ul class="internal"><li class="toplevel"><a class="toctext" href="#Add-any-missing-packages-needed-for-this-tutorial:-1">Add any missing packages needed for this tutorial:</a></li><li><a class="toctext" href="#Example-of-M-variance-components-1">Example of M variance components</a></li><li class="toplevel"><a class="toctext" href="#Comparing-with-the-MatrixNormal-from-the-distributions-package-for-a-single-variance-component,-we-beat!-1">Comparing with the MatrixNormal from the distributions package for a single variance component, we beat!</a></li><li><a class="toctext" href="#Citations:-1">Citations:</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Trait Simulation Tutorial</a></li></ul><a class="edit-page" href="https://github.com/OpenMendel/TraitSimulation.jl/blob/master/docs/src/index.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Trait Simulation Tutorial</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Trait-Simulation-Tutorial-1" href="#Trait-Simulation-Tutorial-1">Trait Simulation Tutorial</a></h1><p>Authors: Sarah Ji, Janet Sinsheimer, Kenneth Lange</p><h3><a class="nav-anchor" id="Double-check-that-you-are-using-Julia-version-1.0-or-higher-by-checking-the-machine-information-1" href="#Double-check-that-you-are-using-Julia-version-1.0-or-higher-by-checking-the-machine-information-1">Double check that you are using Julia version 1.0 or higher by checking the machine information</a></h3><pre><code class="language-julia">versioninfo()</code></pre><h1><a class="nav-anchor" id="Add-any-missing-packages-needed-for-this-tutorial:-1" href="#Add-any-missing-packages-needed-for-this-tutorial:-1">Add any missing packages needed for this tutorial:</a></h1><p>You can also use the package manager to add the <code>TraitSimulation.jl</code> package by running the following link: </p><pre><code class="language-">pkg&gt; add &quot;https://github.com/sarah-ji/TraitSimulation.jl&quot;</code></pre><h2><a class="nav-anchor" id="Example-of-M-variance-components-1" href="#Example-of-M-variance-components-1">Example of M variance components</a></h2><p>Here for m = 10 random Variance Components, we generate m random covariance matrices, a random design matrix and p regression coefficients to illustrate the simulation of a d-dimensional response matrix for a sample of n = 1000 people.</p><pre><code class="language-julia">using Random
Random.seed!(1234);
n = 1000   # no. observations
d = 2      # dimension of responses
m = 10      # no. variance components
p = 2      # no. covariates

# n-by-p design matrix
X = randn(n, p)

# p-by-d mean component regression coefficient
B = ones(p, d)  

# a tuple of m covariance matrices
# a tuple of m covariance matrices
V = ntuple(x -&gt; zeros(n, n), m) 
for i = 1:m-1
  V_i = [j ? i ? i * (n - j + 1) : j * (n - i + 1) for i in 1:n, j in 1:n]
  copy!(V[i], V_i * V_i&#39;)
end
copy!(V[m], Diagonal(ones(n))) # last covarianec matrix is idendity

# a tuple of m d-by-d variance component parameters
? = ntuple(x -&gt; zeros(d, d), m) 
for i in 1:m
  ?_i = [j ? i ? i * (d - j + 1) : j * (d - i + 1) for i in 1:d, j in 1:d]
  copy!(?[i], ?_i&#39; * ?_i)
end

Random_VCM_Trait = DataFrame(VCM_simulation(X, B, V, ?), [:SimTrait1, :SimTrait2])</code></pre><pre><code class="language-julia">@benchmark VCM_simulation(X, B, V, ?)</code></pre><pre><code class="language-none">BenchmarkTools.Trial: 
  memory estimate:  152.81 MiB
  allocs estimate:  180
  --------------
  minimum time:     199.118 ms (51.36\% GC)
  median time:      204.352 ms (51.57\% GC)
  mean time:        205.967 ms (51.21\% GC)
  maximum time:     226.747 ms (48.48\% GC)
  --------------
  samples:          25
  evals/sample:     1</code></pre><h1><a class="nav-anchor" id="Comparing-with-the-MatrixNormal-from-the-distributions-package-for-a-single-variance-component,-we-beat!-1" href="#Comparing-with-the-MatrixNormal-from-the-distributions-package-for-a-single-variance-component,-we-beat!-1">Comparing with the MatrixNormal from the distributions package for a single variance component, we beat!</a></h1><pre><code class="language-julia">@benchmark LMM_trait_simulation(X*B, VarianceComponent(?[1], V[1]))</code></pre><pre><code class="language-none">BenchmarkTools.Trial: 
  memory estimate:  15.31 MiB
  allocs estimate:  17
  --------------
  minimum time:     9.283 ms (0.00\% GC)
  median time:      12.040 ms (20.83\% GC)
  mean time:        11.598 ms (17.30\% GC)
  maximum time:     15.605 ms (24.83\% GC)
  --------------
  samples:          431
  evals/sample:     1</code></pre><pre><code class="language-julia">using Distributions
function MN_J(X, B, V, ?)
    return(rand(MatrixNormal(X*B, V, ?)))
end

@benchmark MN_J(X, B, V[1], ?[2])</code></pre><pre><code class="language-none">BenchmarkTools.Trial: 
  memory estimate:  15.35 MiB
  allocs estimate:  22
  --------------
  minimum time:     9.341 ms (0.00\% GC)
  median time:      12.143 ms (20.88\% GC)
  mean time:        11.733 ms (17.13\% GC)
  maximum time:     15.821 ms (23.28\% GC)
  --------------
  samples:          426
  evals/sample:     1</code></pre><h2><a class="nav-anchor" id="Citations:-1" href="#Citations:-1">Citations:</a></h2><p>[1] Lange K, Papp JC, Sinsheimer JS, Sripracha R, Zhou H, Sobel EM (2013) Mendel: The Swiss army knife of genetic analysis programs. Bioinformatics 29:1568-1570.`</p><p>[2] OPENMENDEL: a cooperative programming project for statistical genetics. <a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=OPENMENDEL">Hum Genet. 2019 Mar 26. doi: 10.1007/s00439-019-02001-z</a>.</p><footer><hr/></footer></article></body></html>
