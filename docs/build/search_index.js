var documenterSearchIndex = {"docs":
[{"location":"#Trait-Simulation-Tutorial-1","page":"Trait Simulation Tutorial","title":"Trait Simulation Tutorial","text":"","category":"section"},{"location":"#","page":"Trait Simulation Tutorial","title":"Trait Simulation Tutorial","text":"Authors: Sarah Ji, Janet Sinsheimer, Kenneth Lange","category":"page"},{"location":"#Double-check-that-you-are-using-Julia-version-1.0-or-higher-by-checking-the-machine-information-1","page":"Trait Simulation Tutorial","title":"Double check that you are using Julia version 1.0 or higher by checking the machine information","text":"","category":"section"},{"location":"#","page":"Trait Simulation Tutorial","title":"Trait Simulation Tutorial","text":"versioninfo()","category":"page"},{"location":"#Add-any-missing-packages-needed-for-this-tutorial:-1","page":"Trait Simulation Tutorial","title":"Add any missing packages needed for this tutorial:","text":"","category":"section"},{"location":"#","page":"Trait Simulation Tutorial","title":"Trait Simulation Tutorial","text":"You can also use the package manager to add the TraitSimulation.jl package by running the following link: ","category":"page"},{"location":"#","page":"Trait Simulation Tutorial","title":"Trait Simulation Tutorial","text":"pkg> add \"https://github.com/sarah-ji/TraitSimulation.jl\"","category":"page"},{"location":"#Example-of-M-variance-components-1","page":"Trait Simulation Tutorial","title":"Example of M variance components","text":"","category":"section"},{"location":"#","page":"Trait Simulation Tutorial","title":"Trait Simulation Tutorial","text":"Here for m = 10 random Variance Components, we generate m random covariance matrices, a random design matrix and p regression coefficients to illustrate the simulation of a d-dimensional response matrix for a sample of n = 1000 people.","category":"page"},{"location":"#","page":"Trait Simulation Tutorial","title":"Trait Simulation Tutorial","text":"using Random\nRandom.seed!(1234);\nn = 1000   # no. observations\nd = 2      # dimension of responses\nm = 10      # no. variance components\np = 2      # no. covariates\n\n# n-by-p design matrix\nX = randn(n, p)\n\n# p-by-d mean component regression coefficient\nB = ones(p, d)  \n\n# a tuple of m covariance matrices\n# a tuple of m covariance matrices\nV = ntuple(x -> zeros(n, n), m) \nfor i = 1:m-1\n  V_i = [j ? i ? i * (n - j + 1) : j * (n - i + 1) for i in 1:n, j in 1:n]\n  copy!(V[i], V_i * V_i')\nend\ncopy!(V[m], Diagonal(ones(n))) # last covarianec matrix is idendity\n\n# a tuple of m d-by-d variance component parameters\n? = ntuple(x -> zeros(d, d), m) \nfor i in 1:m\n  ?_i = [j ? i ? i * (d - j + 1) : j * (d - i + 1) for i in 1:d, j in 1:d]\n  copy!(?[i], ?_i' * ?_i)\nend\n\nRandom_VCM_Trait = DataFrame(VCM_simulation(X, B, V, ?), [:SimTrait1, :SimTrait2])","category":"page"},{"location":"#","page":"Trait Simulation Tutorial","title":"Trait Simulation Tutorial","text":"@benchmark VCM_simulation(X, B, V, ?)","category":"page"},{"location":"#","page":"Trait Simulation Tutorial","title":"Trait Simulation Tutorial","text":"BenchmarkTools.Trial: \n  memory estimate:  152.81 MiB\n  allocs estimate:  180\n  --------------\n  minimum time:     199.118 ms (51.36\\% GC)\n  median time:      204.352 ms (51.57\\% GC)\n  mean time:        205.967 ms (51.21\\% GC)\n  maximum time:     226.747 ms (48.48\\% GC)\n  --------------\n  samples:          25\n  evals/sample:     1","category":"page"},{"location":"#Comparing-with-the-MatrixNormal-from-the-distributions-package-for-a-single-variance-component,-we-beat!-1","page":"Trait Simulation Tutorial","title":"Comparing with the MatrixNormal from the distributions package for a single variance component, we beat!","text":"","category":"section"},{"location":"#","page":"Trait Simulation Tutorial","title":"Trait Simulation Tutorial","text":"@benchmark LMM_trait_simulation(X*B, VarianceComponent(?[1], V[1]))","category":"page"},{"location":"#","page":"Trait Simulation Tutorial","title":"Trait Simulation Tutorial","text":"BenchmarkTools.Trial: \n  memory estimate:  15.31 MiB\n  allocs estimate:  17\n  --------------\n  minimum time:     9.283 ms (0.00\\% GC)\n  median time:      12.040 ms (20.83\\% GC)\n  mean time:        11.598 ms (17.30\\% GC)\n  maximum time:     15.605 ms (24.83\\% GC)\n  --------------\n  samples:          431\n  evals/sample:     1","category":"page"},{"location":"#","page":"Trait Simulation Tutorial","title":"Trait Simulation Tutorial","text":"using Distributions\nfunction MN_J(X, B, V, ?)\n    return(rand(MatrixNormal(X*B, V, ?)))\nend\n\n@benchmark MN_J(X, B, V[1], ?[2])","category":"page"},{"location":"#","page":"Trait Simulation Tutorial","title":"Trait Simulation Tutorial","text":"BenchmarkTools.Trial: \n  memory estimate:  15.35 MiB\n  allocs estimate:  22\n  --------------\n  minimum time:     9.341 ms (0.00\\% GC)\n  median time:      12.143 ms (20.88\\% GC)\n  mean time:        11.733 ms (17.13\\% GC)\n  maximum time:     15.821 ms (23.28\\% GC)\n  --------------\n  samples:          426\n  evals/sample:     1","category":"page"},{"location":"#Citations:-1","page":"Trait Simulation Tutorial","title":"Citations:","text":"","category":"section"},{"location":"#","page":"Trait Simulation Tutorial","title":"Trait Simulation Tutorial","text":"[1] Lange K, Papp JC, Sinsheimer JS, Sripracha R, Zhou H, Sobel EM (2013) Mendel: The Swiss army knife of genetic analysis programs. Bioinformatics 29:1568-1570.`","category":"page"},{"location":"#","page":"Trait Simulation Tutorial","title":"Trait Simulation Tutorial","text":"[2] OPENMENDEL: a cooperative programming project for statistical genetics. Hum Genet. 2019 Mar 26. doi: 10.1007/s00439-019-02001-z.","category":"page"}]
}
